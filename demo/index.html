<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="referrer" content="no-referrer" />
		<meta http-equiv="Access-Control-Allow-Origin" content="*">
		<title></title>
		<script src="./dom-to-image.es.js" type="module"  ></script>
	
		<style>
			.c-m-box{
				width: 600px;
			}
			.c-m-img{
				width: 100px;
				height: 100px;
				border-radius: 50%;
				border:solid 1px gray;
			}
			.outline {
			    outline: 2px solid red;
			    outline-offset: -2px;
			}
			.c-m-list{
				width: 600px;
				height: 250px;
				/* background-color: aliceblue; */
			}
			.img-list{
				display:flex;
				justify-content: space-between;
			}
			.c-m-name{
				font-size: 15px;
				color:blue;
			}
			.c-m-title{
				font-size: 12px;
				color:indianred;
			}
			.btn-list{
				display: flex;
				justify-content: space-around;
					
			}
			.img-type{
				color:blueviolet;
				font-size:16px;
			}
      .img2{
		position: relative;
        width: 130px;
        height:130px;
        background:url(https://car3.autoimg.cn/cardfs/motobike/g9/M09/6F/D6/640x480_autohomecar__ChsEhWFj9T6ANDJPAAuHoGjRkto243.jpg.webp)  center center no-repeat;
        background-size: contain;
        border:1px solid blue;
        border-radius: 50%;
      }
     .img2::before{
      content: '';
      position: absolute;
   		width: 100%;
      height: 100%;
      background-color: red;
      z-index: -1;
     }
		 input {
			 margin-top:20px;
			 display:block;
			 width: 100px;
			 border:1px solid gray; 
		 }
		 .btn-list{
			 padding-bottom: 10px;
		 }
		</style>
		
	</head>
	<body>
		
		<div id="cmBox" class="c-m-box">
		    <div class="c-m-list">
					<div class="img-list">
		        <!-- <img src="./img/1.jpeg" alt="长天" class="c-m-img"> -->
					<img src="./img/2.png"  alt="" class="c-m-img">
					<div class="img2"></div>
					<img style="width:200px;height:150px; border:1px solid pink" src="//m1.autoimg.cn/newsdfs/g26/M04/6A/D9/516x264_autohomecar__ChwFkGFmq8OAAmCSAAaQ44fMmNY598.png.webp" alt="" crossOrigin="anonymous" />
				</div>
				<input value=""/>
		        <div class="c-m-title">自动生成 <i class="img-type"></i> 图片...</div>
		    </div>
			<div class="btn-list">
				<button class="button" onclick="createImg('toSvg')">生成SVG图片</button>
				<button class="button" onclick="createImg('toJpg')">生成JPG图片</button>
				<button class="button" onclick="createImg('toPng')">生成PNG图片</button>
				<button class="button" onclick="createImg('toCanvas')">生成canvas展示</button>
				<button class="button" onclick="createImg('toBlob')">生成toBlob图片</button>
			</div>
		</div>
  <script type="module">
    import DomToImage from './dom-to-image.es.js';
    console.log(DomToImage)
    var node = document.querySelector('.c-m-list')
    window.domtoimage = new DomToImage({targetNode:node,bgColor:'#fff'});
  </script>
	<script type="text/javascript">
  
    //imagePlaceholder:'https://www.pngkey.com/png/detail/233-2332677_image-500580-placeholder-transparent.png'
		function createImg(type){
			document.querySelector('.img-type').innerHTML = type.replace('to','')
			window.domtoimage[type]()
				.then(function (dataUrl) {
					if(type==='toCanvas'){
						document.body.appendChild(dataUrl);
					}else if(type==='toSvg'){
						// console.log(dataUrl);
						const svg = dataUrl.replace('data:image/svg+xml;charset=utf-8,','').replace(/\%0A/g, '');
						document.body.appendChild(createDocumentFragment(svg));
		 
					}else {
						if(type==='toBlob') { 
							dataUrl = URL.createObjectURL(dataUrl)
							console.log(dataUrl);
						}
						const img = new Image();
						img.src = dataUrl;
						document.body.appendChild(img);
						document.body.appendChild(document.createElement('br'));
					}
					
				})
				.catch(function (error) {
					console.error('oops, something went wrong!', error);
				});
		}
		
		function createDocumentFragment(txt) {
		  const template = `<div class='child'>${txt}</div>`;
		  let frag = document.createRange().createContextualFragment(template);
		  return frag;
		 }
 
   </script>
	</body>
</html>